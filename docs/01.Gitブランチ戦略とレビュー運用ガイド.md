# Gitブランチ戦略とレビュー運用ガイド

## 目次

- [ブランチ命名規則等](#ブランチ命名規則等)
  - [ブランチ戦略](#ブランチ戦略)
  - [パターンA：単独作業（基本パターン）](#パターンa単独作業基本パターン)
  - [パターンB：複数人で同一機能に取り組む場合](#パターンb複数人で同一機能に取り組む場合)
  - [パターンC：他ブランチに依存した作業が必要な場合非推奨](#パターンc他ブランチに依存した作業が必要な場合非推奨)
  - [プレフィックス一覧](#プレフィックス一覧)
- [Pull Request テンプレート](#pull-request-テンプレート)
- [レビューの流れ](#レビューの流れ)

### ブランチ命名規則等

**ブランチ戦略**

- 基本は `develop` からブランチを切る。  
- 原則として `merge` 運用。`rebase` は使用禁止。  
- ブランチの種類ごとに以下の運用パターンに従う。

#### パターンA：単独作業（基本パターン）
- `develop` から `feature/*` ブランチを作成。
- 作業中、必要に応じて `develop` を `merge` して追従。
- 作業完了後、`develop` に向けてPRを作成。

#### パターンB：複数人で同一機能に取り組む場合
- `develop` から共同作業用の親ブランチ（例：`feature/foo-main`）を作成。
- 各メンバーはそこから `feature/foo-sub1`, `feature/foo-sub2` などを作成して作業。
- サブブランチは親ブランチに向けてPRを作成。
- 最終的に親ブランチを `develop` にマージ。
- 全ブランチで `merge` 運用。`rebase`・force pushは禁止。

#### パターンC：他ブランチに依存した作業が必要な場合（非推奨）

- 原則として、未マージブランチに依存した作業は禁止。
- やむを得ず未マージのブランチ（例：`feature/A`）に依存する場合：
  - 一時的に `feature/A` から `feature/B` を作成して作業。
  - `feature/B` は `feature/A` に向けてPRを作成。
  - `feature/A` が `develop` にマージされた後：
    - `feature/B` を `develop` ベースで再構成する。
      - 方法①: `feature/B` の変更内容を一時コミット or スタッシュ → `develop` から新規ブランチ作成 → 作業内容を手動で適用
      - 方法②: `git cherry-pick` 等で変更を移植
  - `rebase` は禁止。必ず `merge` か `cherry-pick` を使う。
- force pushは禁止。

（※ rebaseで依存解消しようとすると履歴事故の可能性が高くなるため、常に安全なmergeベースで処理する）


```
<プレフックス>/<簡易説明>
```

#### プレフィックス一覧

* `feature/` – 新機能追加
* `fix/` – 修正（AI駆動開発でLLMが書いてミスってたなど、バグではない小さな修正。）
* `bugfix/` – バク修正（クリティカルなバグ）
* `setting/` – 雑務的変更・設定変更・依存更新など
* `docs/` – ドキュメントのみ
* `test/` – テストコードの追加・変更

例:
```
feature/user-login
fix/user-login-varidate
docs/readme-update
```

### Pull Request テンプレート

```md
# 概要
<!-- このPRで何をするのか？ -->
- 説明文を簡潔に記載。箇条書き推奨。

## バックログチケットリンク

[Backlogのチケット名](https://...)

## テスト
- [ ] 単体テストを追加/修正した
- [ ] E2Eテストを実施した
- [ ] 動作確認済み（手動確認：@username）

## 備考
<!-- レビュワーに伝えるべき注意事項など -->
```



### レビューの流れ

1. **PR確認**：PR記載内容確認。
2. **コードレビュー**：
   * PRの比較先ブランチ（ベースブランチ）との**差分を確認**。
   * 親ブランチに依存してい
   るPR（例：feature/foo-sub1 → feature/foo-main）の場合、親ブランチのマージ順序も考慮。
   * マージされていないPRに依存していると判断された場合は、**依存先のマージを促すか、分割統合方針を確認**。
3. **マージ基準**：
   * main: リリース済みの安定版
   * develop: 手動動作確認済み
